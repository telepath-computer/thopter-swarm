# Remap prefix from Ctrl-b to Ctrl-a
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Enable mouse support (scroll wheel enters copy-mode and scrolls history)
set -g mouse on

# Explicit WheelUp/Down bindings for panes. tmux 3.3a's built-in default
# doesn't auto-enter copy-mode on scroll, so we must bind it explicitly.
# If the pane's application has mouse tracking, forward the event; otherwise
# enter copy-mode (with -e to auto-exit at bottom) and forward.
bind -T root WheelUpPane if-shell -Ft= '#{mouse_any_flag}' 'send-keys -M' 'copy-mode -e; send-keys -M'
bind -T root WheelDownPane if-shell -Ft= '#{mouse_any_flag}' 'send-keys -M' 'send-keys -M'

# Override default 5-line scroll to 2 lines per wheel tick for smoother scrolling
bind -T copy-mode WheelUpPane select-pane \; send-keys -X -N 2 scroll-up
bind -T copy-mode WheelDownPane select-pane \; send-keys -X -N 2 scroll-down
bind -T copy-mode-vi WheelUpPane select-pane \; send-keys -X -N 2 scroll-up
bind -T copy-mode-vi WheelDownPane select-pane \; send-keys -X -N 2 scroll-down

# Allow OSC 52 clipboard escape sequences to pass through to the terminal
set -g set-clipboard on
# Needed so tmux doesn't eat the escape sequences
set -g allow-passthrough on

# Tell tmux that xterm terminals support extended mouse (SGR protocol).
# SGR mouse uses text-based escape sequences that work reliably with xterm.js.
set -as terminal-features 'xterm*:mouse'
